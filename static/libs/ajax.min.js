!function(e,n){"object"==typeof exports&&"object"==typeof module?module.exports=n():"function"==typeof define&&define.amd?define([],n):"object"==typeof exports?exports.Ajax=n():e.Ajax=n()}(this,function(){return function(e){function n(t){if(o[t])return o[t].exports;var r=o[t]={i:t,l:!1,exports:{}};return e[t].call(r.exports,r,r.exports,n),r.l=!0,r.exports}var o={};return n.m=e,n.c=o,n.i=function(e){return e},n.d=function(e,o,t){n.o(e,o)||Object.defineProperty(e,o,{configurable:!1,enumerable:!0,get:t})},n.n=function(e){var o=e&&e.__esModule?function(){return e["default"]}:function(){return e};return n.d(o,"a",o),o},n.o=function(e,n){return Object.prototype.hasOwnProperty.call(e,n)},n.p="",n(n.s=0)}([function(module,exports){var Ajax=function(){var glob_config={delay:2e3,method:"get",url:"",data:"",async:!0,cache:!1,processData:!0,contentType:"application/x-www-form-urlencoded",showLoading:!0,beforeSend:null,success:function(){},error:function(){}},_beforeSendReq={},reqArr=0,loadSetTimeout,_ajaxSetup=function(e){for(var n in e)glob_config[n]=e[n]};"undefined"!=typeof WConfig&&"undefined"!=typeof WConfig.AjaxSetup&&_ajaxSetup(WConfig.AjaxSetup);var _ajax=function(conf){var xhr=window.XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP"),config={};for(var key in glob_config)config[key]=glob_config[key];for(var key in conf)config[key]=conf[key];config.showLoading&&reqArr++,loadSetTimeout&&clearTimeout(loadSetTimeout),loadSetTimeout=setTimeout(function(){config.showLoading&&reqArr>0&&"undefined"!=typeof EventHub&&EventHub.emit(EventHub.PLATFORM_LOADING,"show")},config.delay),config.cache||(config.url+=-1==config.url.indexOf("?")?"?rand="+Math.random():"&rand="+Math.random()),"application/json"===config.contentType?config.data=JSON.stringify(config.data):config.processData&&(config.data=_translateParams(config.data)),config.method=config.method.toLowerCase(),"get"===config.method&&""!=config.data&&config.data!=undefined&&(config.url+=-1==config.url.indexOf("?")?"?"+config.data:"&"+config.data);var _callback=function(){if("undefined"!=typeof EventHub&&EventHub.emit(EventHub.PLATFORM_AJAX_STATUS,xhr.status),401!=xhr.status){var resText=xhr.responseText,jsonObj="";if(resText!=undefined&&""!=resText&&(jsonObj="undefined"==typeof JSON?eval("("+resText+")"):JSON.parse(resText)),200==xhr.status?config.success(jsonObj):config.error(xhr.status,xhr.statusText,jsonObj),config.statusCode)for(var key in config.statusCode)xhr.status==key&&config.statusCode[key](xhr.status,xhr.statusText,jsonObj,xhr);config.showLoading&&reqArr--,config.showLoading&&reqArr<=0&&"undefined"!=typeof EventHub&&EventHub.emit(EventHub.PLATFORM_LOADING,"hide")}};if(xhr.open(config.method,config.url,config.async),_beforeSendReq={setRequestHeader:function(e,n){xhr.setRequestHeader(e,n)}},config.beforeSend&&0==config.beforeSend(_beforeSendReq))return void _callback();"post"===config.method?(!1!==config.contentType&&xhr.setRequestHeader("Content-Type",config.contentType),xhr.send(config.data)):xhr.send(null),!0===config.async?xhr.onreadystatechange=function(){4==xhr.readyState&&_callback()}:_callback()},_translateParams=function(e){var n=[];for(var o in e)n.push(encodeURIComponent(o)+"="+encodeURIComponent(e[o]));return n.join("&")};return{ajax:function(e){_ajax(e)},get:function(e){e.method="get",_ajax(e)},post:function(e){e.method="post",_ajax(e)},ajaxSetup:function(e){_ajaxSetup(e)}}}();module.exports=Ajax}])});